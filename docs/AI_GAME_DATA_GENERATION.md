# AI 게임 데이터 자동 생성 기능

## 📋 개요

Gemini AI를 활용하여 투자 게임의 뉴스와 주식 가격 데이터를 자동으로 생성하는 기능입니다.

## ✨ 주요 기능

- **자동 뉴스 생성**: 선택한 주식에 맞는 현실적인 뉴스 생성
- **가격 데이터 생성**: 뉴스 영향을 반영한 다음날 주식 가격 생성
- **교육적 시나리오**: 긍정적/부정적 뉴스를 골고루 포함하여 교육 효과 극대화
- **마지막 날 처리**: 마지막 날은 뉴스 없이 최종 가격만 제공

## 🚀 사용 방법

### 1. 환경 변수 설정

`apps/admin/.env.local` 파일에 Gemini API Key를 추가하세요:

```bash
GEMINI_API_KEY=your_gemini_api_key_here
```

**Gemini API Key 발급 방법:**
1. [Google AI Studio](https://makersuite.google.com/app/apikey) 접속
2. "Get API Key" 클릭
3. 생성된 API Key 복사

### 2. 클래스 생성 시 게임 데이터 자동 생성

1. **관리자 페이지** → **수업 관리** → **새 수업 추가**
2. 기본 정보 입력:
   - 수업명
   - 총 게임 일수 (예: 3일, 5일, 8일)
   - 클라이언트 및 담당 매니저
3. **게임 데이터 자동 생성 (AI)** 체크박스 활성화
4. **사용할 주식 선택**:
   - 게임에 사용할 주식을 체크박스로 선택 (최소 1개 이상)
   - 한국, 미국, 일본, 중국 주식 선택 가능
5. **생성 버튼** 클릭

### 3. 생성되는 데이터

#### 뉴스 데이터
- 각 날짜마다 2-3개의 뉴스 자동 생성
- 선택한 주식과 관련된 현실적인 내용
- 긍정적/부정적 영향을 골고루 포함
- **마지막 날은 뉴스 없음**

#### 가격 데이터
- 모든 선택한 주식의 일별 가격 생성
- 가격 범위:
  - 🇰🇷 한국: 10,000원 ~ 1,000,000원
  - 🇺🇸 미국: $50 ~ $500
  - 🇯🇵 일본: ¥1,000 ~ ¥10,000
  - 🇨🇳 중국: ¥100 ~ ¥1,000
- 변동폭: -15% ~ +15% 범위
- **뉴스의 영향이 다음날 가격에 반영됨**

## 📊 예시

### 입력
```
수업명: 서울시 중구청 투자 게임 챌린지
총 게임 일수: 3일
선택 주식:
- 삼성전자 (KR/IT/전자)
- SK하이닉스 (KR/IT/전자)
- Apple (US/IT/전자)
- Tesla (US/자동차)
- NVIDIA (US/IT/반도체)
```

### 출력 (자동 생성)

**Day 1 뉴스:**
- "AI 반도체 시장 급성장 전망" → NVIDIA ↑, SK하이닉스 ↑
- "전기차 배터리 기술 혁신" → Tesla ↑

**Day 2 가격:**
- NVIDIA: $480 → $520 (+8.3%)
- SK하이닉스: 130,000원 → 145,000원 (+11.5%)
- Tesla: $250 → $268 (+7.2%)

**Day 2 뉴스:**
- "반도체 경기 둔화 우려" → 삼성전자 ↓, SK하이닉스 ↓

**Day 3 가격 (뉴스 없음):**
- 삼성전자: 70,000원 → 65,000원 (-7.1%)
- SK하이닉스: 145,000원 → 138,000원 (-4.8%)

## ⚙️ 기술 스택

- **AI 모델**: Gemini 1.5 Pro
- **프롬프트 엔지니어링**: 교육적 시나리오 생성에 최적화
- **데이터 검증**: 생성된 데이터의 형식 및 일관성 검증
- **DB 저장**: PostgreSQL (Neon)

## 🔧 커스터마이징

### 프롬프트 수정

`apps/admin/src/actions/gameDataActions.ts` 파일의 프롬프트를 수정하여 생성되는 데이터를 커스터마이징할 수 있습니다:

```typescript
const prompt = `
당신은 투자 교육 게임을 위한 데이터를 생성하는 전문가입니다.
// 여기에서 프롬프트를 수정하세요
`;
```

### 가격 범위 조정

주식별 가격 범위를 조정하려면 프롬프트의 "가격은 다음 규칙을 따라주세요" 섹션을 수정하세요.

## ⚠️ 주의사항

1. **API 비용**: Gemini API 사용량에 따라 비용이 발생할 수 있습니다
2. **생성 시간**: 일수와 주식 수에 따라 30초 ~ 2분 정도 소요
3. **데이터 품질**: AI가 생성한 데이터이므로 검토 권장
4. **에러 처리**: 생성 실패 시 클래스는 생성되지만 게임 데이터는 없음

## 🐛 트러블슈팅

### "GEMINI_API_KEY가 설정되지 않았습니다"
→ `.env.local` 파일에 API Key가 제대로 설정되었는지 확인
→ 서버 재시작 필요

### "생성된 데이터를 파싱하는데 실패했습니다"
→ Gemini API가 올바른 JSON 형식을 반환하지 못한 경우
→ 다시 시도하거나 주식 수를 줄여보세요

### 생성이 너무 오래 걸림
→ 총 일수나 선택한 주식 수를 줄여보세요
→ 권장: 3-8일, 5-10개 주식

## 📝 향후 개선 계획

- [ ] 생성 진행률 표시
- [ ] 생성된 데이터 미리보기 및 수정
- [ ] 다양한 시나리오 템플릿 제공
- [ ] 더 정교한 가격 변동 알고리즘
- [ ] 여러 AI 모델 지원 (OpenAI GPT, Claude 등)
